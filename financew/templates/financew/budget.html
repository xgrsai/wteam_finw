{% extends 'financew/base.html' %} 
{% block content %}
<div style="font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f9; border-radius: 8px; max-width: 800px; margin: 0 auto; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
    <p style="font-size: 18px; color: #333;">
        {{ budget.name }} {{ budget.amount }} {{ budget.currency }} 
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É -->
        <button id="edit-budget-btn" style="background-color: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s;">
            –ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ
        </button>
    </p>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
    <div id="edit-budget-form" style="display: none; margin-top: 20px; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
        <form method="post" action="{% url 'financew:budget' budget.id %}">
            {% csrf_token %}
            <div style="margin-bottom: 15px;">
                {{ form.as_div }}
            </div>

            <label for="category" style="font-size: 16px; margin-bottom: 8px; display: block;">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</label>
            <select name="category" style="padding: 8px; font-size: 14px; width: 100%; border-radius: 5px; border: 1px solid #ddd; margin-bottom: 15px;">
                {% for category in categories %}
                    <option value="{{ category.id }}" {% if budget.category.id == category.id %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                {% endfor %}
            </select>

            <button type="submit" style="background-color: #4CAF50; color: white; padding: 8px 16px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s;">
                –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
            </button>
            <button type="button" id="cancel-edit-btn" style="background-color: #f44336; color: white; padding: 8px 16px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px; transition: background-color 0.3s;">
                –°–∫–∞—Å—É–≤–∞—Ç–∏
            </button>
        </form>
    </div>

    <a href="{% url 'financew:new_finoperation' budget.id %}" style="color: #4CAF50; text-decoration: none; font-size: 16px; display: inline-block; margin-top: 20px;">
        –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É –æ–ø–µ—Ä–∞—Ü—ñ—é
    </a>

    {% for finoperation in finoperations %}
    <div style="display: flex; align-items: center; gap: 10px; margin-top: 20px; background-color: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
        <!-- –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
        <span style="font-size: 16px; color: #333;">
            {{ finoperation.get_type_display }} - {{ finoperation.amount }} - {{ finoperation.date_added }} - {{ finoperation.category }}
        </span>

        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
        <a href="#" class="edit-finoperation-btn" data-finoperation-id="{{ finoperation.id }}" style="color: #2196F3; text-decoration: none; font-size: 14px;">
            –ó–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é
        </a>

        <!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
        <div id="edit-finoperation-form-{{ finoperation.id }}" class="edit-finoperation-form" style="display: none; margin-top: 10px;">
            <form method="POST" action="{% url 'financew:edit_finoperation' finoperation.id %}" style="display: flex; gap: 10px;">
                {% csrf_token %}
                <input type="number" name="amount" value="{{ finoperation.amount }}" placeholder="–°—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó" required style="padding: 8px; font-size: 14px; width: 200px; border-radius: 5px; border: 1px solid #ddd;">
                <select name="type" style="padding: 8px; font-size: 14px; border-radius: 5px; border: 1px solid #ddd;">
                    <option value="expense" {% if finoperation.type == 'expense' %}selected{% endif %}>–í–∏—Ç—Ä–∞—Ç–∞</option>
                    <option value="income" {% if finoperation.type == 'income' %}selected{% endif %}>–ü—Ä–∏–±—É—Ç–æ–∫</option>
                </select>
                <button type="submit" style="background-color: #4CAF50; color: white; padding: 8px 16px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s;">
                    –ó–º—ñ–Ω–∏—Ç–∏
                </button>
            </form>
        </div>

        <!-- –í–∏–¥–∞–ª–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
        <a href="{% url 'financew:delete_finoperation' finoperation.id %}" style="color: #f44336; font-size: 14px; margin-left: 10px;">
            üóë –í–∏–¥–∞–ª–∏—Ç–∏
        </a>
    </div>
    {% empty %}
        <p style="color: #333; font-size: 16px;">–ù–µ–º–∞ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π</p>
    {% endfor %}
</div>

<script>
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è –±—é–¥–∂–µ—Ç—É
    const editBudgetBtn = document.getElementById("edit-budget-btn");
    const editBudgetForm = document.getElementById("edit-budget-form");
    const cancelEditBtn = document.getElementById("cancel-edit-btn");

    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ"
    editBudgetBtn.addEventListener("click", function(event) {
        event.preventDefault();
        editBudgetForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É
    cancelEditBtn.addEventListener("click", function() {
        editBudgetForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
    const editFinoperationBtns = document.querySelectorAll(".edit-finoperation-btn");

    editFinoperationBtns.forEach(function(button) {
        button.addEventListener("click", function(event) {
            event.preventDefault();

            // –û—Ç—Ä–∏–º—É—î–º–æ ID —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const finoperationId = button.getAttribute("data-finoperation-id");

            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ü—ñ—î—ó —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const form = document.getElementById("edit-finoperation-form-" + finoperationId);

            // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å —Ñ–æ—Ä–º–∏
            if (form.style.display === "none") {
                form.style.display = "block";
            } else {
                form.style.display = "none";
            }
        });
    });
</script>

{% endblock content %}

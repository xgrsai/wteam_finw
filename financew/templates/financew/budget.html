{% extends 'financew/base.html' %} 
{% block content %}
<p>{{ budget.name }} {{ budget.amount }} {{ budget.currency }} <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É --><button id="edit-budget-btn">–ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ</button></p>

<!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
<div id="edit-budget-form" style="display: none;">
    <form method="post" action="{% url 'financew:budget' budget.id %}">
        {% csrf_token %}
        {{form.as_div}}
        {% comment %} <label for="name">–ù–∞–∑–≤–∞ –±—é–¥–∂–µ—Ç—É:</label>
        <input type="text" name="name" value="{{ budget.name }}" required>
        <label for="amount">–°—É–º–∞:</label>
        <input type="number" name="amount" value="{{ budget.amount }}" required>
        <label for="currency">–í–∞–ª—é—Ç–∞:</label>
        <input type="text" name="currency" value="{{ budget.currency }}" required> {% endcomment %}
        
        <button type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
        <button type="button" id="cancel-edit-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </form>
</div>

<a href="{% url "financew:new_finoperation" budget.id %}">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É –æ–ø–µ—Ä–∞—Ü—ñ—é</a>
{% for finoperation in finoperations %}
<div style="display: flex; align-items: center; gap: 10px;">

    <!-- –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <span>{{ finoperation.get_type_display }} - {{ finoperation.amount }} - {{ finoperation.date_added }}</span>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <a href="#" class="edit-finoperation-btn" data-finoperation-id="{{ finoperation.id }}" style="color: blue; text-decoration: none;">–ó–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é</a>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
    <div id="edit-finoperation-form-{{ finoperation.id }}" class="edit-finoperation-form" style="display: none;">
        <form method="POST" action="{% url 'financew:edit_finoperation' finoperation.id %}">
            {% csrf_token %}
            <input type="number" name="amount" value="{{ finoperation.amount }}" placeholder="–°—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó" required>
            <select name="type">
                <option value="expense" {% if finoperation.type == 'expense' %}selected{% endif %}>–í–∏—Ç—Ä–∞—Ç–∞</option>
                <option value="income" {% if finoperation.type == 'income' %}selected{% endif %}>–ü—Ä–∏–±—É—Ç–æ–∫</option>
            </select>
            <button type="submit" >–ó–º—ñ–Ω–∏—Ç–∏</button>
        </form>
    </div>

    <!-- –≤–∏–¥–∞–ª–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <a href="{% url 'financew:delete_finoperation' finoperation.id %}" >üóë –í–∏–¥–∞–ª–∏—Ç–∏</a>
</div>
{% empty %}
<p>–ù–µ–º–∞ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π</p>
{% endfor %}

<script>
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è –±—é–¥–∂–µ—Ç—É
    const editBudgetBtn = document.getElementById("edit-budget-btn");
    const editBudgetForm = document.getElementById("edit-budget-form");
    const cancelEditBtn = document.getElementById("cancel-edit-btn");

    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ"
    editBudgetBtn.addEventListener("click", function(event) {
        event.preventDefault();
        editBudgetForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É
    cancelEditBtn.addEventListener("click", function() {
        editBudgetForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
    const editFinoperationBtns = document.querySelectorAll(".edit-finoperation-btn");

    editFinoperationBtns.forEach(function(button) {
        button.addEventListener("click", function(event) {
            event.preventDefault();

            // –û—Ç—Ä–∏–º—É—î–º–æ ID —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const finoperationId = button.getAttribute("data-finoperation-id");

            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ü—ñ—î—ó —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const form = document.getElementById("edit-finoperation-form-" + finoperationId);

            // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å —Ñ–æ—Ä–º–∏
            if (form.style.display === "none") {
                form.style.display = "block";
            } else {
                form.style.display = "none";
            }
        });
    });
</script>

{% endblock content %}

{% extends 'financew/base.html' %}
{% load static %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/main.css' %}"> 

<p>{{ budget.name }} {{ budget.amount }} {{ budget.currency }} <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É -->
    <button id="edit-budget-btn">–ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ</button></p>

<!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
<div id="edit-budget-form" style="display: none;">
    <form method="post" action="{% url 'financew:budget' budget.id %}">
        {% csrf_token %}
        {{form.as_div}}
        
        {% comment %} <label for="name">–ù–∞–∑–≤–∞ –±—é–¥–∂–µ—Ç—É:</label>
        <input type="text" name="name" value="{{ budget.name }}" required>
        <label for="amount">–°—É–º–∞:</label>
        <input type="number" name="amount" value="{{ budget.amount }}" required>
        <label for="currency">–í–∞–ª—é—Ç–∞:</label>
        <input type="text" name="currency" value="{{ budget.currency }}" required> {% endcomment %}
        
        {% comment %} {% for fm in form %}
        <div class="form-group" style="border: 2px solid red; padding: 10px;">
            <label>{{fm.label}}</label>
            <div>{{fm}} </div>
        </div>
        {% endfor %}  {% endcomment %}


        <button type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
        <button type="button" id="cancel-edit-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </form>
</div>
<button id="forecast-btn">–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏</button>
<p id="forecast-result"></p>



{% comment %} <a href="{% url "financew:new_finoperation" budget.id %}">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É –æ–ø–µ—Ä–∞—Ü—ñ—é</a> {% endcomment %}
<button id="add-new-finoperation">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–Ω–æ–ø–µ—Ä–∞—Ü—ñ—é</button>
<div id = 'new-finoperation-form' style = "display:none;">
<form action="{% url 'financew:budget' budget.id %}" method="post" class="new-finoperation-form"> <!-- action - –∫—É–¥–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è —Ñ–æ—Ä–º–∞-->
  {% csrf_token %} 
  {{ new_finoperation_form.as_div }}
  <button type="submit">–î–æ–¥–∞—Ç–∏ —Ñ—ñ–Ω –æ–ø–µ—Ä–∞—Ü—ñ—é</button>
  <button type='button' id="cancel-new-finoperation">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
</form>
</div>
<br>

{% for finoperation,edit_finoperation_form in finoperations_and_edit_forms %}
<div style="display: flex; align-items: center; gap: 10px;">
    <!-- –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <span>{{ finoperation.get_type_display }} - {{ finoperation.amount }} - {{ finoperation.date_added }} - {{ finoperation.category }}</span>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <button type='button' class="edit-finoperation-btn" data-finoperation-id="{{ finoperation.id }}">–ó–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é</button>
    <!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞) -->
    <div id="edit-finoperation-form-{{ finoperation.id }}" class="edit-finoperation-form" style="display: none;">
        <form method="POST" action="{% url 'financew:budget' budget.id %}">
            {% csrf_token %}
            {% comment %} <input type="number" name="amount" value="{{ finoperation.amount }}" placeholder="–°—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó" required>
            <select name="type">
                <option value="expense" {% if finoperation.type == 'expense' %}selected{% endif %}>–í–∏—Ç—Ä–∞—Ç–∞</option>
                <option value="income" {% if finoperation.type == 'income' %}selected{% endif %}>–ü—Ä–∏–±—É—Ç–æ–∫</option>
            </select> {% endcomment %}
            {{edit_finoperation_form.as_div}}
            <button type="submit" >–ó–º—ñ–Ω–∏—Ç–∏</button>
            <button class="cancel-finoperation-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </form>
    </div>

    <!-- –≤–∏–¥–∞–ª–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó -->
    <a href="{% url 'financew:delete_finoperation' finoperation.id %}" >üóë –í–∏–¥–∞–ª–∏—Ç–∏</a>
</div>


{% empty %}
<p>–ù–µ–º–∞ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π</p>
{% endfor %}



–¢—Ä–∞–Ω—Å—Ñ–µ—Ä–∏ –∑ –±—é–¥–∂–µ—Ç—É –≤ –±—é–¥–∂–µ—Ç:
<table border="1">
    <thead>
        <tr>
            <th>–î–∞—Ç–∞</th>
            <th>–ó –±—é–¥–∂–µ—Ç—É</th>
            <th>–£ –±—é–¥–∂–µ—Ç</th>
            <th>–°—É–º–∞</th>
        </tr>
    </thead>
    <tbody>
        {% for transfer in transfers %}
        <tr>
            <td>{{ transfer.date_added }}</td>
            <td>{{ transfer.from_budget.name }}</td>
            <td>
                {% if transfer.to_budget %}
                    {{ transfer.to_budget.name }}
                    {% else %}
                    {{ transfer.to_goalbudget.name }}
                {% endif %}
            </td>
            <td>{{ transfer.amount }} {{ transfer.from_budget.currency }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">–ù–µ–º–∞—î –ø–µ—Ä–µ–∫–∞–∑—ñ–≤</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!--–§–æ—Ä–º–∞ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É-->
<div>
<button id="add-budget-transfer">–ó–¥—ñ–π—Å–Ω–∏—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é –¥–æ –±—é–¥–∂–µ—Ç—É</button>
<div id = 'new-budget-transfer-form' style = "display:none;">
<form action="{% url 'financew:budget' budget.id %}" method="post">
    {%csrf_token%}
    {{transferbudgetform.as_div}}
    <button type="submit">–ó–¥—ñ–π—Å–Ω–∏—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä</button>
    <button type="button" id="cancel-budget-transfer">–°–∫–∞—Å—É–≤–∞—Ç–∏</button> <!--type="button" - —â–æ–± –Ω–µ –¥—É–º–∞–ª–æ —â–æ —Ü–µ submit-->
</form>
</div>
</div>

<!--–§–æ—Ä–º–∞ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ-->
<div>
<button id="add-goalbudget-transfer">–ó–¥—ñ–π—Å–Ω–∏—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ</button>
<div id = 'new-goalbudget-transfer-form' style = "display:none;">
    <form action="{% url 'financew:budget' budget.id %}" method="post">
        {%csrf_token%}
        {{transfergoalbudgetform.as_div}}
        <button type="submit">–ó–¥—ñ–π—Å–Ω–∏—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä</button>
        <button type="button" id="cancel-goalbudget-transfer">–°–∫–∞—Å—É–≤–∞—Ç–∏</button> <!--type="button" - —â–æ–± –Ω–µ –¥—É–º–∞–ª–æ —â–æ —Ü–µ submit-->
    </form>
    </div>
</div>

<script>
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è –±—é–¥–∂–µ—Ç—É
    const editBudgetBtn = document.getElementById("edit-budget-btn");
    const editBudgetForm = document.getElementById("edit-budget-form");
    const cancelEditBtn = document.getElementById("cancel-edit-btn");
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É
    const newBudgetTransferBtn = document.getElementById("add-budget-transfer");
    const newBudgetTransferForm = document.getElementById("new-budget-transfer-form");
    const cancelBudgetTransferBtn = document.getElementById("cancel-budget-transfer");
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ
    const newGoalBudgetTransferBtn = document.getElementById("add-goalbudget-transfer");
    const newGoalBudgetTransferForm = document.getElementById("new-goalbudget-transfer-form");
    const cancelGoalBudgetTransferBtn = document.getElementById("cancel-goalbudget-transfer");
    // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è new_finoperation
    const newFinOperationBtn = document.getElementById("add-new-finoperation");
    const newFinOperationForm = document.getElementById("new-finoperation-form");
    const cancelFinOperationBtn = document.getElementById("cancel-new-finoperation");

    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ó–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ"
    editBudgetBtn.addEventListener("click", function(event) {
        event.preventDefault();
        editBudgetForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });
    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±—é–¥–∂–µ—Ç—É
    cancelEditBtn.addEventListener("click", function() {
        editBudgetForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
        editBudgetBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É
    newBudgetTransferBtn.addEventListener("click", function(event) {
    event.preventDefault();
    newBudgetTransferForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
    newBudgetTransferBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });
    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –¥–æ –±—é–¥–∂–µ—Ç—É
    cancelBudgetTransferBtn.addEventListener("click", function() {
    newBudgetTransferForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
    newBudgetTransferBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });

    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ
    newGoalBudgetTransferBtn.addEventListener("click", function(event) {
    event.preventDefault();
    newGoalBudgetTransferForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
    newGoalBudgetTransferBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });
    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ
    cancelGoalBudgetTransferBtn.addEventListener("click", function() {
    newGoalBudgetTransferForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
    newGoalBudgetTransferBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    });
    
    // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—É –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ
    newFinOperationBtn.addEventListener("click", function(event) {
        event.preventDefault();
        newFinOperationForm.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É
        newFinOperationBtn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
        });
    // –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –¥–æ –±—é–¥–∂–µ—Ç—É-—Ü—ñ–ª—ñ
    cancelFinOperationBtn.addEventListener("click", function() {
        newFinOperationForm.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É
        newFinOperationBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
        });

    
// –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
const editFinOperationBtns = document.querySelectorAll('.edit-finoperation-btn');
const cancelFinOperationBtns = document.querySelectorAll('.cancel-finoperation-btn');
const editFinOperationForms = document.querySelectorAll('.edit-finoperation-form');

document.addEventListener("DOMContentLoaded", function() { // "DOMContentLoaded" —Ü–µ –ø–æ–¥—ñ—è –≤ JavaScript, —è–∫–∞ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î, –∫–æ–ª–∏ –≤–µ—Å—å HTML-–¥–æ–∫—É–º–µ–Ω—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —ñ —Ä–æ–∑–ø–∞—Ä—Å–µ–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–º, –∞–ª–µ —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –≤—Å—ñ –∑–æ–≤–Ω—ñ—à–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —Å—Ç–∏–ª—ñ CSS, –∞–±–æ —Å–∫—Ä–∏–ø—Ç–∏. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—ñ–ª—å–∫–∏ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ DOM, —Ç–æ–¥—ñ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ DOMContentLoaded. –Ø–∫—â–æ –∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ—á–µ–∫–∞—Ç–∏—Å—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ç–æ–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ load.
    // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ "–ó–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é"
    const editFinOperationBtns = document.querySelectorAll('.edit-finoperation-btn');
    
    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ "–ó–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é"
    editFinOperationBtns.forEach((btn) => {
        btn.addEventListener("click", function(event) {
            event.preventDefault();
            const finoperationId = btn.getAttribute('data-finoperation-id'); // –û—Ç—Ä–∏–º—É—î–º–æ ID –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const form = document.getElementById(`edit-finoperation-form-${finoperationId}`);

            // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
            form.style.display = "block";
            btn.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
        });
    });

    // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ "–°–∫–∞—Å—É–≤–∞—Ç–∏"
    const cancelFinOperationBtns = document.querySelectorAll('.cancel-finoperation-btn');

    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ "–°–∫–∞—Å—É–≤–∞—Ç–∏"
    cancelFinOperationBtns.forEach((btn) => {
        btn.addEventListener("click", function(event) {
            event.preventDefault(); // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ —Ñ–æ—Ä–º–∏ –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—é —Å—Ç–æ—Ä—ñ–Ω–∫–∏
            const form = btn.closest('.edit-finoperation-form'); // –û—Ç—Ä–∏–º—É—î–º–æ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—É —Ñ–æ—Ä–º—É
            const editBtn = document.querySelector(`.edit-finoperation-btn[data-finoperation-id="${form.id.replace('edit-finoperation-form-', '')}"]`);

            // –°—Ö–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
            form.style.display = "none";
            editBtn.style.display = "inline"; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
        });
    });
});

 //–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –≤–∏—Ç—Ä–∞—Ç
    document.getElementById("forecast-btn").addEventListener("click", function () {
        // –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π URL —Ç–∞ –ø–∞—Ä—Å–∏–º–æ ID –±—é–¥–∂–µ—Ç—É
        const pathParts = window.location.pathname.split('/');
        const budgetId = pathParts[2]; // –Ø–∫—â–æ URL –≤–∏–≥–ª—è–¥–∞—î —è–∫ /budget/1/

        if (!budgetId) {
            document.getElementById("forecast-result").innerText = "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∑–Ω–∞—á–∏—Ç–∏ ID –±—é–¥–∂–µ—Ç—É";
            return;
        }

        fetch(`/budget/${budgetId}/expenses_forecast/`)
            .then(response => response.json())
            .then(data => {
                document.getElementById("forecast-result").innerText = data.error 
                    ? "–ü–æ–º–∏–ª–∫–∞: " + data.error 
                    : "–ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –º—ñ—Å—è—Ü—å: " + data.predicted_expenses;
            })
            .catch(error => {
                document.getElementById("forecast-result").innerText = "–©–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫";
            });
    });
</script>

{% endblock content %}
{% comment %} // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
    const editFinoperationBtns = document.querySelectorAll(".edit-finoperation-btn");
    editFinoperationBtns.forEach(function(button) {
        button.addEventListener("click", function(event) {
            event.preventDefault(); // —Ü–µ –±–ª–æ–∫—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Ñ–æ—Ä–º–∏ (–±–µ–∑ –ø–µ—Ä–µ–Ω–∞–ø—Ä–≤–ª–µ–Ω—å) (–ø–æ—è—Å—Ç–µ–Ω–Ω—è –ß–ê–¢–ì–ü–¢ -  –±–ª–æ–∫—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É –ø–æ–¥—ñ—ó, —Ç–æ–±—Ç–æ –≤—ñ–Ω –Ω–µ –¥–æ–∑–≤–æ–ª—è—î –±—Ä–∞—É–∑–µ—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–æ—Ä–º—É, –Ω–µ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Å—Ç–æ—Ä—ñ–Ω–∫—É —ñ –Ω–µ –≤–∏–∫–æ–Ω—É—î –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è, —è–∫–µ –∑–∞–∑–≤–∏—á–∞–π –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.)

            // –û—Ç—Ä–∏–º—É—î–º–æ ID —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const finoperationId = button.getAttribute("data-finoperation-id");

            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ñ–æ—Ä–º—É –¥–ª—è —Ü—ñ—î—ó —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
            const form = document.getElementById("edit-finoperation-form-" + finoperationId);

            // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å —Ñ–æ—Ä–º–∏
            if (form.style.display === "none") {
                form.style.display = "block";
            } else {
                form.style.display = "none";
            }
        });
    }); {% endcomment %}